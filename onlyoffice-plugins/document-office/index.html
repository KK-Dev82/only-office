<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DocumentOffice Assistant</title>
    <!-- ONLYOFFICE Plugin SDK (required for window.Asc.plugin.executeMethod/callCommand/etc.) -->
    <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.js"></script>
    <!-- ONLYOFFICE UI helpers + base styles -->
    <script type="text/javascript" src="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins-ui.js"></script>
    <link rel="stylesheet" href="https://onlyoffice.github.io/sdkjs-plugins/v1/plugins.css" />
    <link rel="stylesheet" href="styles.css?v=0.1.15" />
    <!-- no bundler: load multiple scripts in order -->
    <!-- NOTE: do NOT use defer; SDK may call Asc.plugin.init before deferred scripts run -->
    <script type="text/javascript" src="core/ns.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/util.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/telemetry.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/storage.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/editor.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/bus.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/uiwatch.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/tabs.js?v=0.1.15"></script>
    <script type="text/javascript" src="core/debug.js?v=0.1.15"></script>
    <script type="text/javascript" src="features/clipboard.js?v=0.1.15"></script>
    <script type="text/javascript" src="features/macros.js?v=0.1.15"></script>
    <!-- InputHelper typing/token detection (runs in background) -->
    <script type="text/javascript" src="features/inputhelper.js?v=0.1.15"></script>
    <script type="text/javascript" src="bootstrap.js?v=0.1.15"></script>
  </head>
  <body>
    <!-- Fallback marker: if you see this, HTML loaded but CSS/JS may be blocked -->
    <div id="doBootMarker" style="position:fixed;left:6px;bottom:6px;z-index:2147483647;background:rgba(0,0,0,0.55);color:#fff;font:12px system-ui;padding:2px 6px;border-radius:6px;pointer-events:none;">
      DO boot (0.1.15)
    </div>
    <!-- Flow marker: visible even if fixed positioning breaks -->
    <div id="doFlowMarker" style="padding:6px 10px;font:12px system-ui;color:#111; background:#fff; border-bottom:1px dashed #ddd;">
      DO flow marker (0.1.15)
    </div>
    <div class="doRoot">
      <header class="doHeader">
        <div class="doHeaderLeft">
          <div class="doTitle">DocumentOffice</div>
          <div class="doBadges">
            <span class="doBadge" id="pluginVersion">v?</span>
          </div>
        </div>
        <div class="doHeaderRight">
          <div class="doStatus" id="status">loading‚Ä¶</div>
          <button class="doBtnGhost" id="toggleDebug" type="button">Debug</button>
        </div>
      </header>

      <div class="doTabsScroll" role="tablist" aria-label="DocumentOffice tabs">
        <button class="doTabBtn doIsActive" id="tabBtn-clipboard" type="button" data-tab="clipboard">
          üìã Clipboard
        </button>
        <button class="doTabBtn" id="tabBtn-macros" type="button" data-tab="macros">
          üß© Macros
        </button>
      </div>

      <main class="doMain">
        <section class="doTabPanel doIsActive" id="tab-clipboard" data-tab="clipboard">
          <div class="doPanelHeader">
            <div class="doPanelTitle">üìã Clipboard</div>
            <div class="doPanelActions">
              <button id="clipReload" type="button">Reload Clipboard</button>
            </div>
          </div>

          <div class="doRow">
            <input id="clipText" class="doInput" placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô Clipboard..." />
            <button id="clipAdd" type="button">‡πÄ‡∏û‡∏¥‡πà‡∏° Clipboard</button>
          </div>

          <div class="doCard">
            <div class="doSubtitle">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Clipboard</div>
            <div id="clipList" class="doList"></div>
          </div>
        </section>

        <section class="doTabPanel" id="tab-macros" data-tab="macros">
          <div class="doPanelHeader">
            <div class="doPanelActions">
              <button id="macroOpenAdd" type="button">‡πÄ‡∏û‡∏¥‡πà‡∏° Macro</button>
              <button id="macroReload" type="button">Reload Macros</button>
            </div>
          </div>

          <div class="doCard" style="margin-top: 10px;">
            <div class="doSubtitle">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Macros</div>
            <div id="macroList" class="doList"></div>
          </div>
        </section>

        <section class="doDebugPanel doIsHidden" id="debugPanel">
          <div class="doPanelHeader">
            <div class="doPanelTitle">Debug</div>
            <div class="doPanelActions">
              <button id="btnGetSelection" type="button">Get selection</button>
              <button id="btnGetContext" type="button">Get context</button>
              <button id="btnInsertDemo" type="button">Insert demo</button>
            </div>
          </div>
          <pre class="doOutput" id="output"></pre>
        </section>
      </main>
    </div>

    <!-- Add Macro Modal -->
    <div class="doModalOverlay doIsHidden" id="macroAddModal" role="dialog" aria-modal="true" aria-label="‡πÄ‡∏û‡∏¥‡πà‡∏° Macro">
      <div class="doModal">
        <div class="doModalHeader">
          <div class="doModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏° Macro</div>
          <button class="doBtnGhost" id="macroModalClose" type="button">‡∏õ‡∏¥‡∏î</button>
        </div>
        <div class="doModalBody">
          <div class="doMuted" style="margin-bottom: 8px;">
            - ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)<br />
            - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ comma: <code>‡∏ä‡∏∑‡πà‡∏≠1, ‡∏ä‡∏∑‡πà‡∏≠2, ‡∏ä‡∏∑‡πà‡∏≠3</code> (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ comma ‡∏à‡∏£‡∏¥‡∏á ‡πÉ‡∏ä‡πâ <code>\,</code>)<br />
            - ‡∏ñ‡πâ‡∏≤ ‚Äú‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‚Äù ‡∏°‡∏µ <code>{item}</code> ‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏õ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà ‡πÄ‡∏ä‡πà‡∏ô <code>[tab][tab]{item} : </code><br />
            - ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏î Tab ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‡πÅ‡∏•‡∏∞‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö token: <code>[tab]</code> <code>[space]</code> <code>[nl]</code>
          </div>

          <div class="doRow">
            <input id="macroModalName" class="doInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠ Macro (‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô) ‚Äî ‡πÉ‡∏™‡πà {item} ‡πÑ‡∏î‡πâ" />
          </div>

          <div class="doRow">
            <textarea id="macroModalText" class="doTextarea doTextareaLarge" placeholder="‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞ Insert (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Tab/‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà) ‚Äî ‡πÉ‡∏™‡πà {item} ‡πÑ‡∏î‡πâ"></textarea>
          </div>

          <div class="doRow" style="flex-wrap: wrap;">
            <button id="macroModalInsertTab" type="button">+ [tab]</button>
            <button id="macroModalInsertSpace" type="button">+ [space]</button>
            <button id="macroModalInsertNewline" type="button">+ [nl]</button>
            <button id="macroModalInsertColonSpace" type="button">+ :‚ê†</button>
          </div>

          <div class="doRow">
            <textarea id="macroModalItems" class="doTextarea" placeholder="‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (‡∏Ñ‡∏±‡πà‡∏ô‡∏î‡πâ‡∏ß‡∏¢ ,) ‡πÄ‡∏ä‡πà‡∏ô ‡∏ô‡∏≤‡∏¢‡∏Å, ‡∏£‡∏≠‡∏á‡∏ô‡∏≤‡∏¢‡∏Å, ‡πÄ‡∏•‡∏Ç‡∏≤‡∏Ø"></textarea>
          </div>
        </div>
        <div class="doModalFooter">
          <button id="macroModalCancel" type="button">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button id="macroModalSave" type="button">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
      </div>
    </div>
  </body>
</html>

